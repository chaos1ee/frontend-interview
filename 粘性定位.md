# 粘性定位



>滚动容器（scroll container）：overflow-x、overflow-y、overflow属性的计算值不为visible、clip的块级容器。
>
>scrollport：滚动容器的 viewport，与该滚动容器的padding box一致。



## 定义

粘性定位与相对定位类似，不同之处在于它的偏移量是参照最近祖先滚动容器的scrollport自动调整的，可以看做是相对定位与固定定位的结合。在粘性元素（sticky element，设置了“position:sticky”的元素）与最近的scrollport的偏移量达到offsets的阈值之前，粘性元素按照正常文档流定位，在超过给定的offsets后它会按照固定定位的方式偏移。这种定位方案被称作粘性定位。



## 粘性定位计算方式

粘性定位会根据最近的scrollport自动计算偏移量。对于粘性定位的盒子，内插属性表示最近的scrollport各自边缘的内插，定义用于约束box位置的粘性视图矩形（sticky view rectangle ）。

如果在任一轴向的粘性视图矩形尺寸小于该轴向粘性盒子的border box尺寸，则在受影响的轴向，

举个例子：

假设粘性定位的盒子border box的高度是”200px“，top为”20px“，bottom为“0px”，最近的scrollport的高度是“300px”，这时会产生一个“280px”高的



## 粘性定位特性

粘性定位具有以下特性：

1. 须指定 top, right, bottom 或 left 四个阈值其中之一，才可使粘性定位生效。否则其行为与相对定位相同。并且 top 和 bottom 同时设置时，top 生效的优先级高，left 和 right 同时设置时，left 的优先级高。
2. 粘性元素的任意祖先节点的overflow属性必须是visible，否则粘性定位不会生效（如果 position:sticky 元素的任意祖先节点定位设置为 overflow:hidden，则父容器无法滚动，所以 position:sticky 元素也不会有滚动然后固定的情况；如果 position:sticky 元素的任意祖先节点定位设置为 position:relative | absolute | fixed，则元素相对父元素进行定位，而不会相对 viewprot 定位）。



## 兼容性

css sticky兼容性如下图：

![Hao Li > 2020/05/07 > 粘性定位 > FireShot Capture 141 - Can I use... Support tables for HTML5, CSS3, etc - caniuse.com.png](http://confluence.alauda.cn/download/attachments/67546604/FireShot%20Capture%20141%20-%20Can%20I%20use...%20Support%20tables%20for%20HTML5%2C%20CSS3%2C%20etc%20-%20caniuse.com.png?version=1&modificationDate=1588934300000&api=v2)

图片来源 https://caniuse.com/#feat=css-sticky

## 参考

1. [CSS Positioned Layout Module Level 3](https://drafts.csswg.org/css-position-3/#position-property)

